---
import AdminLayout from "@layouts/AdminLayout.astro";

export const prerender = false;
---

<AdminLayout title="站点设置" description="管理员配置站点运行时设置">
	<div class="space-y-4 text-75">
		<section class="card-base px-9 py-6 rounded-[var(--radius-large)]">
			<h1 class="text-4xl font-bold text-black/90 dark:text-white/90 mb-2 relative
				before:w-1 before:h-8 before:rounded-md before:bg-[var(--primary)]
				before:absolute before:top-1/2 before:-translate-y-1/2 before:-left-4">站点设置</h1>
			<p class="text-base text-70">管理站点运行时配置，保存后在缓存周期内自动生效。</p>
		</section>

		<div id="ss-authenticated" class="space-y-4">

			<!-- ===== Section 1: 站点信息 ===== -->
			<section class="card-base p-8 rounded-[var(--radius-large)] space-y-4">
				<h2 class="text-2xl font-semibold text-90">站点信息</h2>
				<form id="ss-site-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
					<label class="space-y-1.5">
						<span class="text-sm text-60">站点标题</span>
						<input id="ss-title" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 placeholder:text-50" placeholder="My Blog" />
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">站点副标题</span>
						<input id="ss-subtitle" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 placeholder:text-50" placeholder="A place for stories" />
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">站点关键词（用逗号分隔）</span>
						<input id="ss-keywords" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 placeholder:text-50" placeholder="blog, tech, life" />
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">建站日期</span>
						<input id="ss-start-date" type="date" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75" />
					</label>
					<hr class="border-[var(--line-divider)] md:col-span-2" />
					<h3 class="text-lg font-medium text-75 md:col-span-2">站点图标</h3>
					<div class="md:col-span-2 space-y-2">
						<div class="flex flex-wrap items-center gap-2">
							<button type="button" id="ss-favicon-upload-btn" class="px-3 py-1.5 rounded-lg border border-[var(--line-divider)] text-sm text-75 hover:border-[var(--primary)] hover:text-[var(--primary)] transition-colors">上传图片</button>
							<span class="text-xs text-50">支持 PNG/JPG/ICO，最大 1.5MB</span>
						</div>
						<div id="ss-favicon-list" class="space-y-2"></div>
					</div>
					<hr class="border-[var(--line-divider)] md:col-span-2" />
					<h3 class="text-lg font-medium text-75 md:col-span-2">统计（Umami）</h3>
					<label class="flex items-center gap-3 text-75 cursor-pointer select-none md:col-span-2">
						<input type="checkbox" id="ss-umami-enabled" class="toggle-checkbox" />
						<span class="toggle-track"><span class="toggle-knob"></span></span>
						启用 Umami
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">Umami Base URL</span>
						<input id="ss-umami-url" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 placeholder:text-50" placeholder="https://umami.example.com" />
					</label>
					<label class="space-y-1.5 md:col-span-2">
						<span class="text-sm text-60">Umami Scripts</span>
						<textarea id="ss-umami-scripts" class="w-full min-h-24 rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 font-mono text-xs placeholder:text-50" placeholder="<script ...></script>"></textarea>
					</label>
					<div class="md:col-span-2 flex items-center gap-2 pt-2">
						<button type="submit" class="px-4 py-2 rounded-lg bg-[var(--btn-regular-bg)] text-[var(--btn-content)] text-sm">保存站点信息</button>
						<span id="ss-site-msg" class="text-sm text-60"></span>
					</div>
				</form>
			</section>

			<!-- ===== Section 2: 导航栏 ===== -->
			<section class="card-base p-8 rounded-[var(--radius-large)] space-y-4">
				<h2 class="text-2xl font-semibold text-90">导航栏</h2>
				<form id="ss-nav-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
					<label class="space-y-1.5">
						<span class="text-sm text-60">导航模式</span>
						<select id="ss-navbar-mode" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75">
							<option value="logo">Logo</option>
							<option value="text-icon">文字+图标</option>
						</select>
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">导航标题文本</span>
						<input id="ss-navbar-text" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 placeholder:text-50" placeholder="Site Title" />
					</label>
					<div class="md:col-span-2 space-y-1.5">
						<span class="text-sm text-60">导航链接</span>
						<div id="ss-nav-links-list" class="space-y-2"></div>
					</div>
					<div class="md:col-span-2 flex items-center gap-2 pt-2">
						<button type="submit" class="px-4 py-2 rounded-lg bg-[var(--btn-regular-bg)] text-[var(--btn-content)] text-sm">保存导航设置</button>
						<span id="ss-nav-msg" class="text-sm text-60"></span>
					</div>
				</form>
			</section>

			<!-- ===== Section 3: 首页设置 ===== -->
			<section class="card-base p-8 rounded-[var(--radius-large)] space-y-4">
				<h2 class="text-2xl font-semibold text-90">首页设置</h2>
				<form id="ss-home-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
					<h3 class="text-lg font-medium text-75 md:col-span-2">轮播壁纸</h3>
					<label class="space-y-1.5">
						<span class="text-sm text-60">壁纸模式</span>
						<select id="ss-wallpaper-mode" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75">
							<option value="banner">banner</option>
							<option value="none">none</option>
						</select>
					</label>
					<label class="flex items-center gap-3 text-75 cursor-pointer select-none md:col-span-2">
						<input type="checkbox" id="ss-banner-carousel-enable" class="toggle-checkbox" />
						<span class="toggle-track"><span class="toggle-knob"></span></span>
						启用 Banner 轮播
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">轮播间隔（秒）</span>
						<input id="ss-banner-carousel-interval" type="number" min="1" max="120" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75" placeholder="5" />
					</label>
					<div class="md:col-span-2 space-y-2">
						<h4 class="text-base font-medium text-75">桌面端 Banner</h4>
						<div class="flex flex-wrap items-center gap-2">
							<button type="button" id="ss-banner-desktop-upload-btn" class="px-3 py-1.5 rounded-lg border border-[var(--line-divider)] text-sm text-75 hover:border-[var(--primary)] hover:text-[var(--primary)] transition-colors">上传图片</button>
							<span class="text-xs text-50">拖拽调整顺序</span>
						</div>
						<div id="ss-banner-desktop-list" class="space-y-2"></div>
					</div>
					<div class="md:col-span-2 space-y-2">
						<h4 class="text-base font-medium text-75">移动端 Banner</h4>
						<div class="flex flex-wrap items-center gap-2">
							<button type="button" id="ss-banner-mobile-upload-btn" class="px-3 py-1.5 rounded-lg border border-[var(--line-divider)] text-sm text-75 hover:border-[var(--primary)] hover:text-[var(--primary)] transition-colors">上传图片</button>
							<span class="text-xs text-50">拖拽调整顺序</span>
						</div>
						<div id="ss-banner-mobile-list" class="space-y-2"></div>
					</div>
					<div class="md:col-span-2 flex items-center gap-2 pt-2">
						<button type="submit" class="px-4 py-2 rounded-lg bg-[var(--btn-regular-bg)] text-[var(--btn-content)] text-sm">保存首页设置</button>
						<span id="ss-home-msg" class="text-sm text-60"></span>
					</div>
				</form>
			</section>

			<!-- ===== Section 4: 文章设置 ===== -->
			<section class="card-base p-8 rounded-[var(--radius-large)] space-y-4">
				<h2 class="text-2xl font-semibold text-90">文章设置</h2>
				<form id="ss-feature-form" class="grid grid-cols-1 md:grid-cols-2 gap-4 text-base">
					<label class="flex items-center gap-3 text-75 cursor-pointer select-none">
						<input type="checkbox" id="ss-toc-enable" class="toggle-checkbox" />
						<span class="toggle-track"><span class="toggle-knob"></span></span>
						启用 TOC
					</label>
					<label class="flex items-center gap-3 text-75 cursor-pointer select-none">
						<input type="checkbox" id="ss-toc-jp" class="toggle-checkbox" />
						<span class="toggle-track"><span class="toggle-knob"></span></span>
						使用日文序号
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">TOC 模式</span>
						<select id="ss-toc-mode" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75">
							<option value="sidebar">sidebar</option>
							<option value="float">float</option>
						</select>
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">TOC 深度</span>
						<select id="ss-toc-depth" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
						</select>
					</label>
					<div class="md:col-span-2 flex items-center gap-2 pt-2">
						<button type="submit" class="px-4 py-2 rounded-lg bg-[var(--btn-regular-bg)] text-[var(--btn-content)] text-sm">保存文章设置</button>
						<span id="ss-feature-msg" class="text-sm text-60"></span>
					</div>
				</form>
			</section>

			<!-- ===== Section 5: 公告与页脚 ===== -->
			<section class="card-base p-8 rounded-[var(--radius-large)] space-y-4">
				<h2 class="text-2xl font-semibold text-90">公告与页脚</h2>
				<form id="ss-announce-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
					<h3 class="text-lg font-medium text-75 md:col-span-2">公告</h3>
					<label class="flex items-center gap-3 text-75 cursor-pointer select-none md:col-span-2">
						<input type="checkbox" id="ss-ann-closable" class="toggle-checkbox" />
						<span class="toggle-track"><span class="toggle-knob"></span></span>
						公告可关闭
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">公告标题</span>
						<input id="ss-ann-title" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 placeholder:text-50" placeholder="Welcome!" />
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">公告内容</span>
						<textarea id="ss-ann-content" class="w-full min-h-24 rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 placeholder:text-50" placeholder="公告正文..."></textarea>
					</label>
					<label class="flex items-center gap-3 text-75 cursor-pointer select-none md:col-span-2">
						<input type="checkbox" id="ss-ann-link-enable" class="toggle-checkbox" />
						<span class="toggle-track"><span class="toggle-knob"></span></span>
						启用公告链接
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">公告链接文本</span>
						<input id="ss-ann-link-text" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 placeholder:text-50" placeholder="了解更多" />
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">公告链接 URL</span>
						<input id="ss-ann-link-url" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 placeholder:text-50" placeholder="https://..." />
					</label>
					<hr class="border-[var(--line-divider)] md:col-span-2" />
					<h3 class="text-lg font-medium text-75 md:col-span-2">页脚</h3>
					<label class="flex items-center gap-3 text-75 cursor-pointer select-none md:col-span-2">
						<input type="checkbox" id="ss-footer-enable" class="toggle-checkbox" />
						<span class="toggle-track"><span class="toggle-knob"></span></span>
						启用页脚自定义 HTML
					</label>
					<label class="space-y-1.5 md:col-span-2">
						<span class="text-sm text-60">页脚 HTML（保存时会服务端 sanitize）</span>
						<textarea id="ss-footer-html" class="w-full min-h-32 rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 font-mono text-xs placeholder:text-50" placeholder="<p>ICP 备案号</p>"></textarea>
					</label>
					<div class="md:col-span-2 flex items-center gap-2 pt-2">
						<button type="submit" class="px-4 py-2 rounded-lg bg-[var(--btn-regular-bg)] text-[var(--btn-content)] text-sm">保存公告与页脚</button>
						<span id="ss-announce-msg" class="text-sm text-60"></span>
					</div>
				</form>
			</section>

			<!-- ===== Section 6: 其它设置 ===== -->
			<section class="card-base p-8 rounded-[var(--radius-large)] space-y-4">
				<h2 class="text-2xl font-semibold text-90">其它设置</h2>
				<form id="ss-other-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
					<h3 class="text-lg font-medium text-75 md:col-span-2">音乐播放器</h3>
					<label class="flex items-center gap-3 text-75 cursor-pointer select-none md:col-span-2">
						<input type="checkbox" id="ss-music-enable" class="toggle-checkbox" />
						<span class="toggle-track"><span class="toggle-knob"></span></span>
						启用音乐播放器
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">模式</span>
						<select id="ss-music-mode" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75">
							<option value="meting">meting</option>
							<option value="local">local</option>
						</select>
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">Meting API</span>
						<input id="ss-music-api" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 placeholder:text-50" placeholder="https://api.injahow.cn/meting/" />
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">歌单 ID</span>
						<input id="ss-music-id" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 placeholder:text-50" />
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">服务器</span>
						<input id="ss-music-server" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 placeholder:text-50" placeholder="netease" />
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">类型</span>
						<input id="ss-music-type" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75 placeholder:text-50" placeholder="playlist" />
					</label>
					<label class="space-y-1.5">
						<span class="text-sm text-60">歌曲名滚动速度</span>
						<input id="ss-music-marquee" type="number" min="0" max="200" class="w-full rounded-lg border border-[var(--line-divider)] px-3.5 py-2.5 bg-transparent text-75" placeholder="30" />
					</label>
					<hr class="border-[var(--line-divider)] md:col-span-2" />
					<h3 class="text-lg font-medium text-75 md:col-span-2">樱花特效</h3>
					<label class="flex items-center gap-3 text-75 cursor-pointer select-none">
						<input type="checkbox" id="ss-sakura-enable" class="toggle-checkbox" />
						<span class="toggle-track"><span class="toggle-knob"></span></span>
						启用樱花特效
					</label>
					<div class="md:col-span-2 flex items-center gap-2 pt-2">
						<button type="submit" class="px-4 py-2 rounded-lg bg-[var(--btn-regular-bg)] text-[var(--btn-content)] text-sm">保存其它设置</button>
						<span id="ss-other-msg" class="text-sm text-60"></span>
					</div>
				</form>
			</section>

		</div>
	</div>

	<div
		slot="modal"
		id="ss-image-crop-modal"
		class="fixed inset-0 z-[9999] hidden items-center justify-center bg-black/70 px-4 py-5"
		tabindex="-1"
	>
		<div id="ss-image-crop-panel" class="card-base w-full max-w-2xl max-h-[92vh] overflow-y-auto rounded-[var(--radius-large)] border border-[var(--line-divider)] p-5 sm:p-6 space-y-4 text-75">
			<div class="flex items-center gap-2">
				<h3 id="ss-image-crop-title" class="text-lg sm:text-xl font-semibold text-90">裁剪图片</h3>
			</div>
			<p id="ss-image-crop-help" class="text-sm text-60">选择图片后，可拖拽调整位置并通过滑块缩放。</p>
			<div
				id="ss-image-crop-viewport"
				class="relative mx-auto w-full max-w-[640px] overflow-hidden rounded-2xl border border-[var(--line-divider)] bg-black/15 dark:bg-white/10 select-none touch-none"
				style="aspect-ratio: 16 / 9;"
			>
				<img id="ss-image-crop-image" class="absolute left-0 top-0 max-w-none pointer-events-none hidden" alt="待裁剪图片" />
				<div
					id="ss-image-crop-empty"
					class="absolute inset-0 grid place-items-center text-sm text-60 pointer-events-none"
				>
					请选择图片
				</div>
				<div class="absolute inset-0 pointer-events-none rounded-2xl ring-2 ring-white/80"></div>
			</div>
			<div class="space-y-1">
				<label for="ss-image-crop-zoom" class="text-sm text-60">缩放</label>
				<input id="ss-image-crop-zoom" type="range" min="100" max="300" step="1" value="100" class="w-full" />
			</div>
			<div class="flex flex-wrap items-center gap-3">
				<input id="ss-image-crop-file" type="file" accept="image/*" class="hidden" />
				<button type="button" id="ss-image-crop-select-btn" class="px-4 py-2.5 rounded-lg border border-[var(--line-divider)] text-sm text-75">
					选择文件
				</button>
				<button type="button" id="ss-image-crop-apply-btn" class="px-4 py-2.5 rounded-lg bg-[var(--btn-regular-bg)] text-[var(--btn-content)] text-sm">
					确认裁剪
				</button>
				<button type="button" id="ss-image-crop-cancel-btn" class="ml-auto px-4 py-2.5 rounded-lg border border-[var(--line-divider)] text-sm text-75">
					取消
				</button>
			</div>
			<span id="ss-image-crop-msg" class="text-sm text-red-500"></span>
		</div>
	</div>
</AdminLayout>
